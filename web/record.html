<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–æ–ª–æ—Å–æ–≤—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è - –ó–∞–ø–∏—Å—å</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 500px;
            margin: 50px auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: bold;
        }
        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        button {
            padding: 12px 24px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        button.recording {
            background: #f44336;
            animation: pulse 1.5s infinite;
        }
        .hidden {
            display: none;
        }
        .status {
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.processing {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .timer {
            font-size: 24px;
            text-align: center;
            margin: 20px 0;
            color: #333;
            font-weight: bold;
        }
        .nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        .nav a {
            flex: 1;
            text-align: center;
            text-decoration: none;
            padding: 10px;
            background: #007bff;
            color: white;
            border-radius: 5px;
        }
        .nav a:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 5px;
            border: 1px solid #c8e6c9;
        }
        .result h3 {
            margin-top: 0;
            color: #155724;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(244, 67, 54, 0); }
            100% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0); }
        }
        audio {
            width: 100%;
            margin: 10px 0;
        }
        .info {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #1565c0;
            border: 1px solid #bbdefb;
        }
        .debug {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            color: #666;
            border: 1px solid #ddd;
            max-height: 150px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
<div class="nav">
    <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
    <a href="/record.html">–ó–∞–ø–∏—Å—å</a>
    <a href="/reminders.html">–ú–æ–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</a>
</div>

<div class="info">
    üí° <strong>–í–∞–∂–Ω–æ:</strong> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø–∏—Å–∏ –∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–º —Ä–∞–±–æ—á–µ–º AudioRecorderService (16kHz, 16-bit, mono)
</div>

<h2 style="text-align: center; color: #333; margin-bottom: 30px;">–ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h2>

<div class="form-group">
    <label for="userId">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
    <input type="text" id="userId" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à ID" required value="test-user-123">
</div>

<div class="form-group">
    <label for="userEmail">Email:</label>
    <input type="email" id="userEmail" placeholder="–í–∞—à email –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π" required value="test@example.com">
</div>

<div class="timer" id="timer">00:00</div>

<audio id="audioPreview" controls class="hidden"></audio>

<button id="recordButton">üé§ –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å</button>

<div class="status" id="status"></div>

<div id="result" class="result hidden">
    <h3>–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ!</h3>
    <p><strong>ID –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:</strong> <span id="reminderId"></span></p>
    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="reminderStatus">–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è...</span></p>
    <a href="/reminders.html" id="viewRemindersLink" style="color: #007bff; text-decoration: none; font-weight: bold;">
        –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
    </a>
</div>

<div class="debug hidden" id="debug">
    <strong>–û—Ç–ª–∞–¥–∫–∞:</strong>
    <div id="debugLog"></div>
</div>

<script>
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioContext;

    let mediaRecorder;
    let audioChunks = [];
    let isRecording = false;
    let timerInterval;
    let seconds = 0;
    let maxDuration = 30;

    const recordButton = document.getElementById('recordButton');
    const timerElement = document.getElementById('timer');
    const statusElement = document.getElementById('status');
    const resultElement = document.getElementById('result');
    const audioPreview = document.getElementById('audioPreview');
    const debugElement = document.getElementById('debug');
    const debugLog = document.getElementById('debugLog');

    recordButton.addEventListener('click', toggleRecording);

    function debug(message) {
        console.log(message);
        debugLog.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${message}</div>`;
        debugElement.classList.remove('hidden');
        debugElement.scrollTop = debugElement.scrollHeight;
    }

    async function toggleRecording() {
        if (!isRecording) {
            await startRecording();
        } else {
            stopRecording();
        }
    }

    async function startRecording() {
        const userId = document.getElementById('userId').value.trim();
        const userEmail = document.getElementById('userEmail').value.trim();

        if (!userId || !userEmail) {
            showStatus('–í–≤–µ–¥–∏—Ç–µ ID –∏ email –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é', 'error');
            return;
        }

        debug('–ù–∞—á–∏–Ω–∞—é –∑–∞–ø–∏—Å—å...');

        try {
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∞—É–¥–∏–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–∞–∫ –≤ AudioRecorderService
            const constraints = {
                audio: {
                    sampleRate: 16000, // –∫–∞–∫ –≤ AudioRecorderService
                    channelCount: 1,    // mono –∫–∞–∫ –≤ AudioRecorderService
                    echoCancellation: true,
                    noiseSuppression: true,
                    autoGainControl: true,
                    sampleSize: 16      // 16-bit –∫–∞–∫ –≤ AudioRecorderService
                }
            };

            debug('–ó–∞–ø—Ä–∞—à–∏–≤–∞—é –º–∏–∫—Ä–æ—Ñ–æ–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: sampleRate=16000, channels=1, sampleSize=16');

            const stream = await navigator.mediaDevices.getUserMedia(constraints);
            const audioTrack = stream.getAudioTracks()[0];
            const settings = audioTrack.getSettings();

            debug(`–ü–æ–ª—É—á–µ–Ω –ø–æ—Ç–æ–∫: sampleRate=${settings.sampleRate}, channels=${settings.channelCount}, sampleSize=${settings.sampleSize}`);

            // –°–æ–∑–¥–∞–µ–º AudioContext —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            audioContext = new AudioContext({
                sampleRate: 16000 // –§–∏–∫—Å–∏—Ä—É–µ–º 16kHz –∫–∞–∫ –≤ AudioRecorderService
            });

            debug(`AudioContext —Å–æ–∑–¥–∞–Ω —Å sampleRate=${audioContext.sampleRate}`);

            // –ò—Å–ø–æ–ª—å–∑—É–µ–º MediaRecorder –¥–ª—è –∑–∞–ø–∏—Å–∏
            const options = {
                mimeType: 'audio/webm;codecs=opus',
                audioBitsPerSecond: 64000
            };

            try {
                mediaRecorder = new MediaRecorder(stream, options);
                debug(`MediaRecorder —Å–æ–∑–¥–∞–Ω —Å mimeType: ${options.mimeType}`);
            } catch (e) {
                debug(`WebM –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, –æ—à–∏–±–∫–∞: ${e.message}`);
                mediaRecorder = new MediaRecorder(stream);
                debug('–ò—Å–ø–æ–ª—å–∑—É—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π MediaRecorder');
            }

            audioChunks = [];

            mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    audioChunks.push(event.data);
                    debug(`–ü–æ–ª—É—á–µ–Ω –∞—É–¥–∏–æ —á–∞–Ω–∫: ${event.data.size} –±–∞–π—Ç`);
                }
            };

            mediaRecorder.onstop = async () => {
                try {
                    showStatus('–°–æ–∑–¥–∞—é WAV —Ñ–∞–π–ª...', 'processing');
                    debug('–ó–∞–ø–∏—Å—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, —Å–æ–∑–¥–∞—é WAV —Ñ–∞–π–ª');

                    // –°–æ–∑–¥–∞–µ–º Blob –∏–∑ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                    const audioBlob = new Blob(audioChunks, {
                        type: mediaRecorder.mimeType || 'audio/webm'
                    });

                    debug(`–ò—Å—Ö–æ–¥–Ω—ã–π –∞—É–¥–∏–æ Blob: ${audioBlob.size} –±–∞–π—Ç, type: ${audioBlob.type}`);

                    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ WAV –∫–∞–∫ –≤ AudioRecorderService
                    const wavBlob = await convertToWav(audioBlob);

                    debug(`WAV —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω: ${wavBlob.size} –±–∞–π—Ç`);

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é
                    audioPreview.src = URL.createObjectURL(wavBlob);
                    audioPreview.classList.remove('hidden');

                    showStatus('–û—Ç–ø—Ä–∞–≤–ª—è—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä...', 'processing');
                    debug('–û—Ç–ø—Ä–∞–≤–ª—è—é WAV —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä');

                    await sendAudioToServer(wavBlob, userId, userEmail);

                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ:', error);
                    debug(`–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ: ${error.message}`);
                    showStatus('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ', 'error');
                } finally {
                    stream.getTracks().forEach(track => track.stop());
                    if (audioContext) {
                        await audioContext.close();
                        debug('AudioContext –∑–∞–∫—Ä—ã—Ç');
                    }
                }
            };

            mediaRecorder.start(1000); // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
            isRecording = true;
            recordButton.textContent = '‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å';
            recordButton.classList.add('recording');
            startTimer();

            debug('–ó–∞–ø–∏—Å—å –Ω–∞—á–∞—Ç–∞');
            showStatus('–ó–∞–ø–∏—Å—ã–≤–∞—é... –ì–æ–≤–æ—Ä–∏—Ç–µ –≤–∞—à–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ', 'processing');

        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É:', error);
            debug(`–û—à–∏–±–∫–∞: ${error.message}`);
            showStatus(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
        }
    }

    async function convertToWav(audioBlob) {
        debug('–ù–∞—á–∏–Ω–∞—é –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –≤ WAV...');

        try {
            // –ß–∏—Ç–∞–µ–º –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ
            const arrayBuffer = await audioBlob.arrayBuffer();
            debug(`–ü—Ä–æ—á–∏—Ç–∞–Ω arrayBuffer: ${arrayBuffer.byteLength} –±–∞–π—Ç`);

            // –î–µ–∫–æ–¥–∏—Ä—É–µ–º –∞—É–¥–∏–æ
            const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
            debug(`–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–æ –∞—É–¥–∏–æ: sampleRate=${audioBuffer.sampleRate}, duration=${audioBuffer.duration}s, channels=${audioBuffer.numberOfChannels}`);

            // –†–µ—Å–µ–º–ø–ª–∏—Ä—É–µ–º –¥–æ 16kHz –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            let sourceBuffer = audioBuffer;
            if (Math.abs(audioBuffer.sampleRate - 16000) > 100) {
                debug(`–†–µ—Å–µ–º–ø–ª–∏—Ä—É–µ–º —Å ${audioBuffer.sampleRate}Hz –¥–æ 16000Hz`);
                const offlineContext = new OfflineAudioContext(
                    1, // –∫–∞–Ω–∞–ª—ã (mono)
                    audioBuffer.duration * 16000,
                    16000
                );

                const source = offlineContext.createBufferSource();
                source.buffer = audioBuffer;
                source.connect(offlineContext.destination);
                source.start(0);

                sourceBuffer = await offlineContext.startRendering();
                debug(`–†–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ: sampleRate=${sourceBuffer.sampleRate}`);
            }

            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ WAV
            const wavBlob = createWavBlob(sourceBuffer);
            debug(`WAV —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ`);

            return wavBlob;

        } catch (error) {
            debug(`–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏: ${error.message}`);
            throw error;
        }
    }

    function createWavBlob(audioBuffer) {
        // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∫ –≤ AudioRecorderService
        const sampleRate = audioBuffer.sampleRate;
        const channels = 1; // –í—Å–µ–≥–¥–∞ –º–æ–Ω–æ –∫–∞–∫ –≤ AudioRecorderService
        const bitDepth = 16; // 16-bit –∫–∞–∫ –≤ AudioRecorderService
        const format = 1; // PCM

        debug(`–°–æ–∑–¥–∞—é WAV: sampleRate=${sampleRate}, channels=${channels}, bitDepth=${bitDepth}`);

        // –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –∫–∞–Ω–∞–ª (–¥–µ–ª–∞–µ–º –º–æ–Ω–æ)
        const channelData = audioBuffer.getChannelData(0);
        const numSamples = channelData.length;

        const bytesPerSample = bitDepth / 8;
        const blockAlign = channels * bytesPerSample;
        const byteRate = sampleRate * blockAlign;
        const dataSize = numSamples * blockAlign;
        const bufferSize = 44 + dataSize;

        // –°–æ–∑–¥–∞–µ–º –±—É—Ñ–µ—Ä –¥–ª—è WAV –¥–∞–Ω–Ω—ã—Ö
        const buffer = new ArrayBuffer(bufferSize);
        const view = new DataView(buffer);

        // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º WAV –∑–∞–≥–æ–ª–æ–≤–æ–∫
        writeString(view, 0, 'RIFF');
        view.setUint32(4, bufferSize - 8, true);
        writeString(view, 8, 'WAVE');
        writeString(view, 12, 'fmt ');
        view.setUint32(16, 16, true);
        view.setUint16(20, format, true);
        view.setUint16(22, channels, true);
        view.setUint32(24, sampleRate, true);
        view.setUint32(28, byteRate, true);
        view.setUint16(32, blockAlign, true);
        view.setUint16(34, bitDepth, true);
        writeString(view, 36, 'data');
        view.setUint32(40, dataSize, true);

        // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ
        let offset = 44;
        for (let i = 0; i < numSamples; i++) {
            const sample = Math.max(-1, Math.min(1, channelData[i]));
            const intSample = sample < 0 ? sample * 32768 : sample * 32767;
            view.setInt16(offset, intSample, true);
            offset += 2;
        }

        debug(`WAV –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–ø–∏—Å–∞–Ω, –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö: ${numSamples} —Å—ç–º–ø–ª–æ–≤`);
        return new Blob([buffer], { type: 'audio/wav' });
    }

    function writeString(view, offset, string) {
        for (let i = 0; i < string.length; i++) {
            view.setUint8(offset + i, string.charCodeAt(i));
        }
    }

    function stopRecording() {
        if (mediaRecorder && isRecording) {
            debug('–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –∑–∞–ø–∏—Å—å...');
            mediaRecorder.stop();
            isRecording = false;
            recordButton.textContent = 'üé§ –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å';
            recordButton.classList.remove('recording');
            stopTimer();
            showStatus('–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø–∏—Å–∏...', 'processing');
        }
    }

    function startTimer() {
        seconds = 0;
        updateTimer();
        timerInterval = setInterval(() => {
            seconds++;
            updateTimer();

            if (seconds >= maxDuration) {
                debug(`–î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ (${maxDuration} —Å–µ–∫)`);
                stopRecording();
            }
        }, 1000);
    }

    function stopTimer() {
        clearInterval(timerInterval);
    }

    function updateTimer() {
        const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
        const secs = (seconds % 60).toString().padStart(2, '0');
        timerElement.textContent = `${mins}:${secs}`;
    }

    async function sendAudioToServer(audioBlob, userId, userEmail) {
        try {
            showStatus('–û—Ç–ø—Ä–∞–≤–ª—è—é –∞—É–¥–∏–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä...', 'processing');
            debug('–ù–∞—á–∏–Ω–∞—é –æ—Ç–ø—Ä–∞–≤–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä...');

            const formData = new FormData();
            formData.append('audio', audioBlob, 'recording.wav');
            formData.append('userId', userId);
            formData.append('userEmail', userEmail);

            debug(`–û—Ç–ø—Ä–∞–≤–ª—è—é FormData: userId=${userId}, userEmail=${userEmail}, —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞=${audioBlob.size}`);

            const response = await fetch('/api/reminder/record', {
                method: 'POST',
                body: formData
            });

            debug(`–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç: ${response.status} ${response.statusText}`);

            if (!response.ok) {
                const errorText = await response.text();
                debug(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${errorText}`);
                throw new Error(`HTTP error ${response.status}: ${errorText}`);
            }

            const result = await response.json();
            debug(`–£—Å–ø–µ—à–Ω–æ: reminderId=${result.reminderId}`);

            showStatus('–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ!', 'success');
            displayResult(result);

        } catch (error) {
            console.error('Error:', error);
            debug(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${error.message}`);
            showStatus(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
        }
    }

    function showStatus(message, type) {
        statusElement.textContent = message;
        statusElement.className = 'status';
        if (type) {
            statusElement.classList.add(type);
        }
    }

    function displayResult(result) {
        document.getElementById('reminderId').textContent = result.reminderId;

        if (result.scheduledTime) {
            const scheduledTime = new Date(result.scheduledTime);
            document.getElementById('reminderStatus').textContent =
                `–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ ${scheduledTime.toLocaleString('ru-RU')}`;
        }

        const link = document.getElementById('viewRemindersLink');
        link.href = `/reminders.html?userId=${result.userId}`;

        resultElement.classList.remove('hidden');
        resultElement.scrollIntoView({ behavior: 'smooth' });
    }

    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    const urlParams = new URLSearchParams(window.location.search);
    const userIdFromUrl = urlParams.get('userId');
    if (userIdFromUrl) {
        document.getElementById('userId').value = userIdFromUrl;
    }
</script>
</body>
</html>